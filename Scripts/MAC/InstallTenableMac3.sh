#!/bin/bash# Need to run as root to avoid installation problemlinking_key=“23a87832c27177274bd837318f7e22032e4011bec11781209cbbf8ddc4876c4d”nessus_agent_dmg=“NessusAgent-7.6.3.dmg”if [ -z “$linking_key” ];then    echo “Exit: Need Tenable linking key”    exit 1fiif [ -z “$nessus_agent_dmg” ];then    echo “Exit: Need nessus agent dmg file name”    exit 1fi# Mount the dmg packagehdiutil attach “/private/var/tmp/${nessus_agent_dmg}”installer -pkg /Volumes/Nessus\ Agent\ Install/Install\ Nessus\ Agent.pkg -target /hdiutil detach /Volumes/Nessus\ Agent\ Install# Machine name and serial numbercomputer_name=$(scutil --get LocalHostName)serial_number=$(ioreg -c IOPlatformExpertDevice -d 2 | awk -F\” ‘/IOPlatformSerialNumber/{print $(NF-1)}’)# Install agent/Library/NessusAgent/run/sbin/nessuscli agent link \--key=“$linking_key” \--groups=“mac” \--name=“$computer_name:$serial_number” \--cloud# Removing the dmg packagerm “/private/var/tmp/${nessus_agent_dmg}”